<template>
  <div class="u-quill-body">
    <h2>流程图</h2>
    <blockquote>
      <a class="u-color-blue" target="_blank" href="https://www.yuque.com/alsmile/topology/qrukhs">api</a>
      => <code>https://www.yuque.com/alsmile/topology/qrukhs</code>
    </blockquote>
    <blockquote>
      topology =>
      <code>https://www.jsdelivr.com/?query=author%3A%20le5le-com</code>
    </blockquote>
    <div>
      <pre>

    "@topology/activity-diagram": "^0.3.0",
    "@topology/chart-diagram": "^0.3.0",
    "@topology/class-diagram": "^0.3.0",
    "@topology/core": "^0.5.8",
    "@topology/flow-diagram": "^0.3.0",
    "@topology/sequence-diagram": "^0.3.0",
	 </pre
      >
      <hr />
      <blockquote>topology-bundle cdn demo</blockquote>
      <div id="l5l" style="height: 300px; border: 1px solid #e1e1e1; position: relative"></div>
    </div>
  </div>
</template>

<script lang="ts">
import shaonq from 'shaonq'
import { defineComponent, reactive, onMounted } from 'vue'
export default {
  setup() {
    onMounted(async () => {
      if (typeof Le5leTopology === 'undefined') {
        console.time('Le5leTopology')
        await shaonq.loadJs`https://unpkg.com/topology-bundle@0.5.36/index.js`
        console.timeEnd('Le5leTopology')
      }
      const canvas = new Le5leTopology.Topology('l5l', {
        on(event, data) {
          if (data) {
            console.log('onMessage', event, data)
          }
        },
      })
      canvas.open({
        pens: [
          {
            imageRatio: true,
            points: [],
            anchors: [
              { x: 246.7290612277941, y: 128.47677138785372, direction: 4 },
              { x: 306.6690612277942, y: 108.4967713878537, direction: 1 },
              { x: 366.6090612277943, y: 128.47677138785372, direction: 2 },
              { x: 306.6690612277942, y: 148.45677138785376, direction: 3 },
            ],
            manualAnchors: [],
            rotatedAnchors: [
              { x: 246.7290612277941, y: 128.47677138785372, direction: 4 },
              { x: 306.6690612277942, y: 108.4967713878537, direction: 1 },
              { x: 366.6090612277943, y: 128.47677138785372, direction: 2 },
              { x: 306.6690612277942, y: 148.45677138785376, direction: 3 },
            ],
            animateDuration: 0,
            animateFrames: [],
            animateFrame: 0,
            name: 'rectangle',
            tags: [],
            visible: true,
            rect: {
              x: 246.7290612277941,
              y: 108.4967713878537,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 306.6690612277942, y: 128.47677138785372 },
              ex: 366.6090612277943,
              ey: 148.45677138785376,
            },
            fontColor: '#222222',
            fontFamily: '"Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial',
            fontSize: 11.988000000000019,
            lineHeight: 1.5,
            fontStyle: 'normal',
            fontWeight: 'normal',
            textAlign: 'center',
            textBaseline: 'middle',
            textBackground: '',
            animateCycleIndex: 0,
            events: [],
            dash: 0,
            lineDashOffset: 0,
            lineWidth: 0.999000000000002,
            strokeStyle: '#222222',
            fillStyle: '',
            globalAlpha: 1,
            rotate: 0,
            offsetRotate: 0,
            textMaxLine: 0,
            textOffsetX: 0,
            textOffsetY: 0,
            animatePos: 0,
            id: '6b1eea4',
            zRotate: 0,
            borderRadius: 0.5,
            imageAlign: 'center',
            gradientAngle: 0,
            gradientRadius: 0.01,
            paddingTop: 0,
            paddingBottom: 0,
            paddingLeft: 0,
            paddingRight: 0,
            children: [],
            text: '开始',
            type: 0,
            animateType: '',
            paddingLeftNum: 0,
            paddingRightNum: 0,
            paddingTopNum: 0,
            paddingBottomNum: 0,
            textRect: {
              x: 286.6890612277941,
              y: 108.4967713878537,
              width: 79.92000000000014,
              height: 39.960000000000065,
              center: { x: 326.6490612277942, y: 128.47677138785372 },
              ex: 366.60906122779426,
              ey: 148.45677138785376,
            },
            fullTextRect: {
              x: 246.7290612277941,
              y: 108.4967713878537,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 306.6690612277942, y: 128.47677138785372 },
              ex: 366.6090612277943,
              ey: 148.45677138785376,
            },
            iconRect: {
              x: 246.7290612277941,
              y: 108.4967713878537,
              width: 39.960000000000065,
              height: 39.960000000000065,
              center: { x: 266.7090612277941, y: 128.47677138785372 },
              ex: 286.6890612277941,
              ey: 148.45677138785376,
            },
            fullIconRect: {
              x: 246.7290612277941,
              y: 108.4967713878537,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 306.6690612277942, y: 128.47677138785372 },
              ex: 366.6090612277943,
              ey: 148.45677138785376,
            },
            oldRect: {
              x: 119.4526001135294,
              y: 119.2671289179117,
              width: 116.64000000000019,
              height: 38.88000000000006,
              center: { x: 177.7726001135295, y: 138.70712891791175 },
              ex: 236.09260011352958,
              ey: 158.14712891791177,
            },
            z: 0,
            iconSize: 0,
            evs: { x: 333, y: 615 },
            TID: '1e0a8177',
            elementRendered: false,
          },
          {
            imageRatio: true,
            points: [],
            anchors: [
              { x: 325.2290612277935, y: 245.1567713878539, direction: 4 },
              { x: 385.16906122779363, y: 225.17677138785388, direction: 1 },
              { x: 445.10906122779375, y: 245.1567713878539, direction: 2 },
              { x: 385.16906122779363, y: 265.13677138785397, direction: 3 },
            ],
            manualAnchors: [],
            rotatedAnchors: [
              { x: 325.2290612277935, y: 245.1567713878539, direction: 4 },
              { x: 385.16906122779363, y: 225.17677138785388, direction: 1 },
              { x: 445.10906122779375, y: 245.1567713878539, direction: 2 },
              { x: 385.16906122779363, y: 265.13677138785397, direction: 3 },
            ],
            animateDuration: 0,
            animateFrames: [],
            animateFrame: 0,
            name: 'rectangle',
            tags: [],
            visible: true,
            rect: {
              x: 325.2290612277935,
              y: 225.17677138785388,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 385.16906122779363, y: 245.1567713878539 },
              ex: 445.10906122779375,
              ey: 265.13677138785397,
            },
            fontColor: '#222222',
            fontFamily: '"Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial',
            fontSize: 11.988000000000019,
            lineHeight: 1.5,
            fontStyle: 'normal',
            fontWeight: 'normal',
            textAlign: 'center',
            textBaseline: 'middle',
            textBackground: '',
            animateCycleIndex: 0,
            events: [],
            dash: 0,
            lineDashOffset: 0,
            lineWidth: 0.999000000000002,
            strokeStyle: '#222222',
            fillStyle: '',
            globalAlpha: 1,
            rotate: 0,
            offsetRotate: 0,
            textMaxLine: 0,
            textOffsetX: 0,
            textOffsetY: 0,
            animatePos: 0,
            id: '8fad661',
            zRotate: 0,
            borderRadius: 0,
            imageAlign: 'center',
            gradientAngle: 0,
            gradientRadius: 0.01,
            paddingTop: 0,
            paddingBottom: 0,
            paddingLeft: 0,
            paddingRight: 0,
            children: [],
            text: '流程',
            type: 0,
            animateType: '',
            paddingLeftNum: 0,
            paddingRightNum: 0,
            paddingTopNum: 0,
            paddingBottomNum: 0,
            textRect: {
              x: 365.18906122779356,
              y: 225.17677138785388,
              width: 79.92000000000014,
              height: 39.960000000000065,
              center: { x: 405.14906122779365, y: 245.1567713878539 },
              ex: 445.1090612277937,
              ey: 265.13677138785397,
            },
            fullTextRect: {
              x: 325.2290612277935,
              y: 225.17677138785388,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 385.16906122779363, y: 245.1567713878539 },
              ex: 445.10906122779375,
              ey: 265.13677138785397,
            },
            iconRect: {
              x: 325.2290612277935,
              y: 225.17677138785388,
              width: 39.960000000000065,
              height: 39.960000000000065,
              center: { x: 345.20906122779354, y: 245.1567713878539 },
              ex: 365.18906122779356,
              ey: 265.13677138785397,
            },
            fullIconRect: {
              x: 325.2290612277935,
              y: 225.17677138785388,
              width: 119.88000000000021,
              height: 39.960000000000065,
              center: { x: 385.16906122779363, y: 245.1567713878539 },
              ex: 445.10906122779375,
              ey: 265.13677138785397,
            },
            oldRect: {
              x: 173.4526001135289,
              y: 214.30712891791188,
              width: 116.64000000000019,
              height: 38.88000000000006,
              center: { x: 231.772600113529, y: 233.7471289179119 },
              ex: 290.0926001135291,
              ey: 253.18712891791193,
            },
            z: 0,
            iconSize: 0,
            evs: { x: 524, y: 711 },
            TID: '1e0a8177',
            elementRendered: false,
          },
          {
            name: 'curve',
            tags: [],
            visible: true,
            rect: {
              x: 0,
              y: 0,
              width: 0,
              height: 0,
              center: { x: 0, y: 0 },
              ex: 0,
              ey: 0,
            },
            fontColor: '',
            fontFamily: '"Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial',
            fontSize: 11.988000000000019,
            lineHeight: 1.5,
            fontStyle: 'normal',
            fontWeight: 'normal',
            textAlign: 'center',
            textBaseline: 'middle',
            textBackground: '#ffffff',
            animateCycleIndex: 0,
            events: [],
            dash: 0,
            lineDashOffset: 0,
            lineWidth: 0.999000000000002,
            strokeStyle: '#222222',
            fillStyle: '',
            globalAlpha: 1,
            rotate: 0,
            offsetRotate: 0,
            textMaxLine: 0,
            textOffsetX: 0,
            textOffsetY: 0,
            animatePos: 0,
            id: '0d19d98',
            fromArrow: '',
            toArrow: 'triangleSolid',
            controlPoints: [
              {
                x: 306.6690612277942,
                y: 228.45677138785376,
                direction: 3,
                anchorIndex: 3,
                id: '6b1eea4',
              },
              {
                x: 385.16906122779363,
                y: 145.17677138785388,
                direction: 1,
                anchorIndex: 1,
                id: '8fad661',
              },
            ],
            fromArrowSize: 5,
            toArrowSize: 5,
            borderWidth: 0,
            borderColor: '#000000',
            animateColor: '',
            animateSpan: 1,
            animateFromSize: 0,
            animateToSize: 0,
            animateDotSize: 3,
            from: {
              x: 306.6690612277942,
              y: 148.45677138785376,
              direction: 3,
              anchorIndex: 3,
              id: '6b1eea4',
            },
            to: {
              x: 385.16906122779363,
              y: 225.17677138785388,
              direction: 1,
              anchorIndex: 1,
              id: '8fad661',
            },
            type: 1,
            evs: { x: 514, y: 668 },
            TID: '1e0a8177',
          },
        ],
        lineName: 'curve', // 当前图文默认连线类型
        fromArrow: '', // 开始箭头
        toArrow: 'triangleSolid', // 结束箭头
        scale: 1, // 缩放 0-1
        locked: 1, // 0 未锁定，1只读，2不能移动，10 完全锁定
        x: 0,
        y: 0,
        rule: true,
        ruleColor: '#000',
        scroll: true,
      })
    })
    return {}
  },
}
</script>
